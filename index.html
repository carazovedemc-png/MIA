<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Assistant ‚Ä¢ Telegram Mini App</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ —Å–∫—Ä–æ–ª–ª–±–∞—Ä–∞ */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: rgba(255,255,255,0.05); }
        ::-webkit-scrollbar-thumb { background: rgba(99,102,241,0.5); border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: rgba(99,102,241,0.8); }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- –û—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç -->
        <div class="chat-container">
            <!-- –®–∞–ø–∫–∞ -->
            <header class="chat-header">
                <div class="header-left">
                    <div class="logo">
                        <i class="fas fa-robot"></i>
                        <h1>AI Assistant</h1>
                    </div>
                    <div class="status-indicator" id="apiStatusIndicator">
                        <div class="status-dot"></div>
                        <span id="statusText">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</span>
                    </div>
                </div>
                <div class="header-actions">
                    <button id="clearChatBtn" class="icon-btn" title="–û—á–∏—Å—Ç–∏—Ç—å —á–∞—Ç">
                        <i class="fas fa-trash-alt"></i>
                    </button>
                    <button id="settingsBtn" class="icon-btn primary" title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏">
                        <i class="fas fa-cog"></i>
                    </button>
                </div>
            </header>

            <!-- –ò—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π -->
            <div class="messages-container" id="messagesContainer">
                <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –∑–¥–µ—Å—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                <div class="message ai-welcome">
                    <div class="message-avatar">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="message-content">
                        <div class="message-sender">AI Assistant</div>
                        <div class="message-text">
                            üëã –ü—Ä–∏–≤–µ—Ç! –Ø –≤–∞—à AI-–ø–æ–º–æ—â–Ω–∏–∫. <br><br>
                            üîë <strong>–ß—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å:</strong><br>
                            1. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ <i class="fas fa-cog"></i> –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É<br>
                            2. –í–≤–µ–¥–∏—Ç–µ –≤–∞—à API –∫–ª—é—á –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö<br>
                            3. –ù–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏"<br><br>
                            üí° <strong>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è:</strong><br>
                            ‚Ä¢ DeepSeek API<br>
                            ‚Ä¢ OpenAI API<br>
                            ‚Ä¢ –ò –¥—Ä—É–≥–∏–µ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ API
                        </div>
                        <div class="message-time">—Ç–æ–ª—å–∫–æ —á—Ç–æ</div>
                    </div>
                </div>
            </div>

            <!-- –ü–æ–ª–µ –≤–≤–æ–¥–∞ -->
            <div class="input-container">
                <div class="input-wrapper">
                    <textarea 
                        id="messageInput" 
                        placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –∑–∞–ø—Ä–æ—Å –∑–¥–µ—Å—å..." 
                        rows="1"
                        maxlength="4000"
                        autocomplete="off"
                        spellcheck="true"></textarea>
                    <div class="input-actions">
                        <button id="sendButton" class="send-button" title="–û—Ç–ø—Ä–∞–≤–∏—Ç—å (Ctrl+Enter)">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
                <div class="input-hint">
                    <i class="fas fa-info-circle"></i>
                    –ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏, Shift+Enter –¥–ª—è –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
    <div id="settingsModal" class="modal-overlay">
        <div class="modal-container">
            <div class="modal-header">
                <h2><i class="fas fa-sliders-h"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏ AI Assistant</h2>
                <button class="modal-close" id="closeModalBtn">&times;</button>
            </div>
            
            <div class="modal-body">
                <!-- –°–µ–∫—Ü–∏—è API -->
                <div class="settings-section">
                    <h3><i class="fas fa-key"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏ API</h3>
                    
                    <div class="setting-item">
                        <label for="apiProvider">–ü—Ä–æ–≤–∞–π–¥–µ—Ä API</label>
                        <select id="apiProvider" class="setting-select">
                            <option value="deepseek">DeepSeek</option>
                            <option value="openai">OpenAI</option>
                            <option value="custom">–î—Ä—É–≥–æ–π (Custom)</option>
                        </select>
                        <div class="setting-description">
                            –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ AI API
                        </div>
                    </div>

                    <div class="setting-item">
                        <label for="apiKey">API –ö–ª—é—á</label>
                        <div class="input-with-button">
                            <input 
                                type="password" 
                                id="apiKey" 
                                placeholder="sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
                                autocomplete="off">
                            <button type="button" id="toggleKeyBtn" class="small-button">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <div class="setting-description">
                            <i class="fas fa-external-link-alt"></i>
                            <a href="https://platform.deepseek.com/api_keys" target="_blank" class="link">
                                –ü–æ–ª—É—á–∏—Ç—å DeepSeek –∫–ª—é—á
                            </a> ‚Ä¢ 
                            <a href="https://platform.openai.com/api-keys" target="_blank" class="link">
                                –ü–æ–ª—É—á–∏—Ç—å OpenAI –∫–ª—é—á
                            </a>
                        </div>
                    </div>

                    <div class="setting-item">
                        <label for="apiUrl">URL API (–¥–ª—è Custom)</label>
                        <input 
                            type="text" 
                            id="apiUrl" 
                            placeholder="https://api.deepseek.com/v1"
                            class="setting-input">
                        <div class="setting-description">
                            –û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                        </div>
                    </div>

                    <div class="setting-item">
                        <label for="apiModel">–ú–æ–¥–µ–ª—å AI</label>
                        <input 
                            type="text" 
                            id="apiModel" 
                            placeholder="deepseek-chat"
                            class="setting-input">
                        <div class="setting-description">
                            –ù–∞–ø—Ä–∏–º–µ—Ä: deepseek-chat, gpt-3.5-turbo, gpt-4
                        </div>
                    </div>

                    <div class="setting-item">
                        <label for="maxTokens">–ú–∞–∫—Å. –¥–ª–∏–Ω–∞ –æ—Ç–≤–µ—Ç–∞</label>
                        <div class="range-container">
                            <input 
                                type="range" 
                                id="maxTokens" 
                                min="100" 
                                max="4000" 
                                step="100" 
                                value="2000">
                            <span id="tokensValue">2000 —Ç–æ–∫–µ–Ω–æ–≤</span>
                        </div>
                    </div>

                    <div class="setting-actions">
                        <button id="testApiBtn" class="button secondary">
                            <i class="fas fa-vial"></i> –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
                        </button>
                        <div id="apiTestResult" class="test-result"></div>
                    </div>
                </div>

                <!-- –°–µ–∫—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ -->
                <div class="settings-section">
                    <h3><i class="fas fa-paint-brush"></i> –í–Ω–µ—à–Ω–∏–π –≤–∏–¥</h3>
                    
                    <div class="setting-item">
                        <label>–¢–µ–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è</label>
                        <div class="theme-selector">
                            <div class="theme-option active" data-theme="dark">
                                <div class="theme-preview dark-theme">
                                    <div class="theme-header"></div>
                                    <div class="theme-content"></div>
                                </div>
                                <span>–¢—ë–º–Ω–∞—è</span>
                            </div>
                            <div class="theme-option" data-theme="light">
                                <div class="theme-preview light-theme">
                                    <div class="theme-header"></div>
                                    <div class="theme-content"></div>
                                </div>
                                <span>–°–≤–µ—Ç–ª–∞—è</span>
                            </div>
                            <div class="theme-option" data-theme="blue">
                                <div class="theme-preview blue-theme">
                                    <div class="theme-header"></div>
                                    <div class="theme-content"></div>
                                </div>
                                <span>–°–∏–Ω—è—è</span>
                            </div>
                        </div>
                    </div>

                    <div class="setting-item">
                        <label class="checkbox-container">
                            <input type="checkbox" id="autoScroll" checked>
                            <span class="checkmark"></span>
                            <span class="checkbox-label">–ê–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –Ω–æ–≤—ã–º —Å–æ–æ–±—â–µ–Ω–∏—è–º</span>
                        </label>
                    </div>

                    <div class="setting-item">
                        <label class="checkbox-container">
                            <input type="checkbox" id="showTimestamps" checked>
                            <span class="checkmark"></span>
                            <span class="checkbox-label">–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤—Ä–µ–º—è —Å–æ–æ–±—â–µ–Ω–∏–π</span>
                        </label>
                    </div>
                </div>

                <!-- –°–µ–∫—Ü–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ -->
                <div class="settings-section">
                    <h3><i class="fas fa-tools"></i> –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ</h3>
                    
                    <div class="setting-item">
                        <label for="systemPrompt">–°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç</label>
                        <textarea 
                            id="systemPrompt" 
                            rows="3" 
                            placeholder="–í—ã - –ø–æ–ª–µ–∑–Ω—ã–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç. –û—Ç–≤–µ—á–∞–π—Ç–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ..."
                            class="setting-textarea"></textarea>
                        <div class="setting-description">
                            –°–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è AI (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
                        </div>
                    </div>

                    <div class="setting-item">
                        <label for="temperature">–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞</label>
                        <div class="range-container">
                            <input 
                                type="range" 
                                id="temperature" 
                                min="0" 
                                max="1" 
                                step="0.1" 
                                value="0.7">
                            <span id="tempValue">0.7 (–±–∞–ª–∞–Ω—Å)</span>
                        </div>
                        <div class="setting-description">
                            0.0 = —Ç–æ—á–Ω–æ—Å—Ç—å, 1.0 = –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button id="saveSettingsBtn" class="button primary">
                    <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                </button>
                <button id="cancelSettingsBtn" class="button secondary">
                    –û—Ç–º–µ–Ω–∞
                </button>
            </div>
        </div>
    </div>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div id="notificationContainer"></div>

    <script src="app.js"></script>
</body>
</html>